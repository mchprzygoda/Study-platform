<div class="bg-white rounded-lg p-6 shadow-md flex flex-col h-[350px]">
  <div class="mb-6 flex-shrink-0">
    <div class="flex items-center gap-4">
      <div class="flex flex-col items-center justify-center w-[60px] h-[60px] bg-gradient-to-br from-blue-300 to-purple-600 rounded-lg text-white flex-shrink-0">
        <span class="text-2xl font-bold leading-none">{{ dayNumber() }}</span>
        <span class="text-xs uppercase font-medium opacity-90">{{ monthShort() }}</span>
      </div>
      <h3 class="m-0 text-xl font-semibold text-gray-800">Events for {{ formattedDate() }}</h3>
    </div>
  </div>

  <div class="overflow-y-auto overflow-x-hidden flex-1 pr-2 min-h-0">
    @if (processedEvents().length === 0) {
      <div class="text-center py-12 text-gray-500">
        <p class="m-0 text-base">No events for this day</p>
      </div>
    } @else {
      @for (event of processedEvents(); track event.id || event.eventName) {
        <div 
          class="flex items-start gap-4 p-4 border-2 border-gray-200 rounded-lg mb-3 bg-white cursor-pointer transition-all hover:shadow-md hover:border-blue-500 relative"
          (click)="onEdit(event)">
          <div class="flex items-center justify-center min-w-[32px] h-8 bg-gray-100 rounded-full font-semibold text-sm text-gray-700 flex-shrink-0">
            {{ event.index }}
          </div>
          
          <div class="flex-1 flex flex-col gap-1 min-w-0 min-h-0">
            <div class="flex items-center gap-2 flex-wrap flex-shrink-0">
              <p class="m-0 text-base font-semibold text-gray-800">{{ event.eventName }}</p>
              @if (event.isPast) {
                <span class="px-2 py-0.5 bg-orange-500 text-white text-xs font-semibold rounded-full uppercase">Past</span>
              }
            </div>
            @if (event.description) {
              <div class="max-h-20 overflow-y-auto min-h-0">
                <p class="m-0 text-sm text-gray-600 whitespace-pre-wrap break-words">{{ event.description }}</p>
              </div>
            }
            <div class="text-sm text-gray-500 flex-shrink-0">
              <span>{{ formatTime(event.startTime) }} - {{ formatTime(event.endTime) }}</span>
            </div>
          </div>

          <button
            class="bg-transparent border-0 cursor-pointer text-red-600 p-2 rounded-md transition-all flex items-center justify-center flex-shrink-0 hover:bg-red-50 hover:text-red-700 active:bg-red-100"
            (click)="onDelete(event); $event.stopPropagation()"
            aria-label="Delete event"
          >
            <svg class="pointer-events-none" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor">
              <path d="M3 6h14M8 6V4a2 2 0 0 1 2-2h0a2 2 0 0 1 2 2v2m3 0v10a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14zM10 10v4M6 10v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      }
    }
  </div>
</div>

<!-- Delete Confirmation Modal -->
@if (isDeleteConfirmModalOpen()) {
  <app-confirm-delete-modal
    [itemName]="eventToDelete()?.name || ''"
    itemType="event"
    (confirmed)="confirmDelete()"
    (cancelled)="closeDeleteConfirmModal()">
  </app-confirm-delete-modal>
}
