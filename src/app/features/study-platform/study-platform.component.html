<section class="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">
  <div class="container mx-auto px-4 py-8">
    <!-- Welcome Section -->
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-gray-800 mb-2">
        Welcome{{ currentUser()?.username ? ', ' + currentUser()!.username : '' }}!
      </h1>
      <p class="text-lg text-gray-600">
        Welcome to your Study Platform where you can learn, make your notes and prepare for exams.
      </p>
    </div>

    <!-- Recent Notes Panel -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
      <h3 class="text-2xl font-bold text-gray-800 mb-4">Recent Added Notes</h3>
      
      @if (recentNotes() && recentNotes()!.length > 0) {
        <div class="overflow-x-auto pb-4">
          <div class="flex gap-6 min-w-min">
            @for (note of recentNotes()!; track note.id) {
              <div class="flex-shrink-0 w-80">
                <app-card
                  [title]="note.title"
                  [content]="note.content"
                  [subjectName]="note.subjectName"
                  [showActions]="false"
                  [clickable]="true"
                  (cardClick)="navigateToNote(note)">
                </app-card>
              </div>
            }
          </div>
        </div>
      } @else {
        <div class="text-center py-8">
          <p class="text-gray-600 text-lg mb-2">No notes yet.</p>
          <p class="text-gray-400 text-sm">Start by creating your first subject and adding notes!</p>
        </div>
      }
    </div>

    <!-- Upcoming Events Section -->
    <div class="bg-white rounded-lg shadow-md p-6">
      <div class="flex justify-between items-center mb-4 flex-wrap gap-4">
        <h3 class="text-2xl font-bold text-gray-800">Upcoming Events</h3>
        <div class="flex items-center gap-4">
          <label class="relative inline-flex items-center cursor-pointer select-none">
            <input
              type="checkbox"
              [checked]="hidePastEvents()"
              (change)="toggleHidePastEvents()"
              class="sr-only peer"
            />
            <div class="relative w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gradient-to-br peer-checked:from-blue-500 peer-checked:to-purple-600"></div>
            <span class="ml-3 text-sm font-medium text-gray-700" [class.text-blue-600]="hidePastEvents()" [class.font-semibold]="hidePastEvents()">Hide past events</span>
          </label>
          <a 
            routerLink="/calendar"
            class="text-blue-600 hover:text-blue-700 font-medium text-sm transition-colors">
            View Calendar â†’
          </a>
        </div>
      </div>
      
      @if (upcomingEvents() && upcomingEvents()!.length > 0) {
        <div class="max-h-[500px] overflow-y-auto pr-2">
          @for (dayEvents of upcomingEvents(); track dayEvents.date.getTime()) {
            <div class="mb-6 last:mb-0">
              <!-- Day Header -->
              <div class="flex items-center gap-3 mb-3">
                <div class="flex flex-col items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-300 to-purple-600 rounded-lg text-white flex-shrink-0">
                  <span class="text-lg font-bold leading-none">{{ dayEvents.date | date:'d' }}</span>
                  <span class="text-[10px] uppercase font-medium opacity-90">{{ dayEvents.date | date:'MMM' }}</span>
                </div>
                <div>
                  <p class="text-lg font-semibold text-gray-800 m-0">{{ dayEvents.date | date:'EEEE' }}</p>
                  <p class="text-sm text-gray-500 m-0">{{ dayEvents.date | date:'MMMM d, y' }}</p>
                </div>
              </div>
              
              <!-- Events for this day (horizontal scroll) -->
              <div class="overflow-x-auto pb-2">
                <div class="flex gap-4 min-w-min">
                  @for (event of dayEvents.events; track event.id) {
                    <div class="flex-shrink-0 w-72 p-4 border-2 border-gray-200 rounded-lg bg-white hover:border-blue-500 transition-all cursor-pointer hover:shadow-md">
                      <div class="flex items-center gap-2 mb-2 flex-wrap">
                        <p class="text-base font-semibold text-gray-800 m-0">{{ event.eventName }}</p>
                        @if (event.isPast) {
                          <span class="px-2 py-0.5 bg-orange-500 text-white text-xs font-semibold rounded-full uppercase">Past</span>
                        }
                      </div>
                      @if (event.description) {
                        <p class="text-sm text-gray-600 mb-2 line-clamp-2">{{ event.description }}</p>
                      }
                      <div class="flex items-center gap-2 text-sm text-gray-500">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span>{{ formatTime(event.startTime) }} - {{ formatTime(event.endTime) }}</span>
                      </div>
                    </div>
                  }
                </div>
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="text-center py-8">
          <p class="text-gray-600 text-lg mb-2">No upcoming events in the next 7 days</p>
          <button 
            (click)="navigateToCalendar()"
            class="inline-block px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors">
            Add Event
          </button>
        </div>
      }
    </div>
  </div>
</section>
